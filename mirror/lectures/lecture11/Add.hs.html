<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>lectures/lecture11/Add.hs</title>
</head>
<body>
<pre><font color=Blue>{-# LANGUAGE MultiParamTypeClasses #-}</font>
<font color=Blue>{-# LANGUAGE TypeFamilies #-}</font>
<font color=Blue>{-# LANGUAGE FlexibleInstances #-}</font>
<font color=Blue>{-# LANGUAGE FlexibleContexts #-}</font>
<u><font color="#804000">module</font></u> <font color=Green>Add</font> <u><font color="#804000">where</font></u>
<font color=Blue>-- <a href="http://www.haskell.org/haskellwiki/Simonpj/Talk:FunWithTypeFuns">http://www.haskell.org/haskellwiki/Simonpj/Talk:FunWithTypeFuns</a></font>

<font color=Blue>{- Addition in the Num type class has type 
  (Num a) =&gt; a -&gt; a -&gt; a

This allows any numeric type to be used for addition _as long as
both arguments have the same type_. In math it is common to
allow addition of, for example, integers and real
numbers. Defining a more flexible addition is a nice little
excerices in associated types (type families).
-}</font>

<u><font color="#804000">class</font></u> <font color=Green>Add</font> a b <u><font color="#804000">where</font></u>           <font color=Blue>-- uses MultiParamTypeClasses</font>
  <u><font color="#804000">type</font></u> <font color=Green>AddTy</font> a b              <font color=Blue>-- uses TypeFamilies</font>
  add <font color="#808080">::</font> a <font color="#808080">-&gt;</font> b <font color="#808080">-&gt;</font> <font color=Green>AddTy</font> a b

<u><font color="#804000">instance</font></u> <font color=Green>Add</font> <font color=Green>Integer</font> <font color=Green>Double</font> <u><font color="#804000">where</font></u>
  <u><font color="#804000">type</font></u> <font color=Green>AddTy</font> <font color=Green>Integer</font> <font color=Green>Double</font> <font color="#808080">=</font> <font color=Green>Double</font>
  add x y <font color="#808080">=</font> fromIntegral x <font color="#800080">+</font> y

<u><font color="#804000">instance</font></u> <font color=Green>Add</font> <font color=Green>Double</font> <font color=Green>Integer</font> <u><font color="#804000">where</font></u>
  <u><font color="#804000">type</font></u> <font color=Green>AddTy</font> <font color=Green>Double</font> <font color=Green>Integer</font> <font color="#808080">=</font> <font color=Green>Double</font>
  add x y <font color="#808080">=</font> x <font color="#800080">+</font> fromIntegral y

<u><font color="#804000">instance</font></u> <font color="#808080">(</font><font color=Green>Num</font> a<font color="#808080">)</font> <font color="#808080">=&gt;</font> <font color=Green>Add</font> a a <u><font color="#804000">where</font></u> <font color=Blue>-- uses FlexibleInstances</font>
  <u><font color="#804000">type</font></u> <font color=Green>AddTy</font> a a <font color="#808080">=</font> a
  add x y <font color="#808080">=</font> x <font color="#800080">+</font> y

<u><font color="#804000">instance</font></u> <font color="#808080">(</font><font color=Green>Add</font> <font color=Green>Integer</font> a<font color="#808080">)</font> <font color="#808080">=&gt;</font> 
         <font color=Green>Add</font> <font color=Green>Integer</font> <font color="#808080">[</font>a<font color="#808080">]</font> <u><font color="#804000">where</font></u>    <font color=Blue>-- uses FlexibleContexts</font>
  <u><font color="#804000">type</font></u> <font color=Green>AddTy</font> <font color=Green>Integer</font> <font color="#808080">[</font>a<font color="#808080">]</font> <font color="#808080">=</font> <font color="#808080">[</font><font color=Green>AddTy</font> <font color=Green>Integer</font> a<font color="#808080">]</font>
  add x ys <font color="#808080">=</font> map <font color="#808080">(</font>add x<font color="#808080">)</font> ys
<font color=Blue>-- or equivalently </font>
<font color=Blue>-- &gt; add x = map (add x)</font>
<font color=Blue>-- or even</font>
<font color=Blue>-- &gt; add = map . add</font>

<font color=Blue>{- or more generally:
instance Integral a =&gt; Add a Double where
  type AddTy a Double = Double
  add x y = fromIntegral x + y
-}</font>

<font color=Blue>-- --------------</font>
<font color=Blue>--   </font>
test <font color="#808080">::</font> <font color=Green>Double</font>
test <font color="#808080">=</font> add <font color="#808080">(</font><font color=Magenta>3</font><font color="#808080">::</font><font color=Green>Integer</font><font color="#808080">)</font> <font color="#808080">(</font><font color=Magenta>4</font><font color="#808080">::</font><font color=Green>Double</font><font color="#808080">)</font>

aList <font color="#808080">::</font> <font color="#808080">[</font><font color=Green>Integer</font><font color="#808080">]</font>
aList <font color="#808080">=</font>  <font color="#808080">[</font><font color=Magenta>0</font><font color="#808080">,</font><font color=Magenta>6</font><font color="#808080">,</font><font color=Magenta>2</font><font color="#808080">,</font><font color=Magenta>7</font><font color="#808080">]</font>

test2 <font color="#808080">::</font> <font color="#808080">[</font><font color=Green>Integer</font><font color="#808080">]</font>
test2 <font color="#808080">=</font> add <font color="#808080">(</font><font color=Magenta>1</font><font color="#808080">::</font><font color=Green>Integer</font><font color="#808080">)</font> aList

test3 <font color="#808080">::</font> <font color="#808080">[</font><font color=Green>Double</font><font color="#808080">]</font>
test3 <font color="#808080">=</font> add <font color="#808080">(</font><font color=Magenta>38</font><font color="#808080">::</font><font color=Green>Integer</font><font color="#808080">)</font> <font color="#808080">[</font><font color=Magenta>1700</font><font color="#808080">::</font><font color=Green>Double</font><font color="#808080">]</font>

<font color=Blue>-- What is the type of this function?</font>
test4 x y z <font color="#808080">=</font> add x <font color="#808080">(</font>add y z<font color="#808080">)</font>










test4 <font color="#808080">::</font> <font color="#808080">(</font><font color=Green>Add</font> b c<font color="#808080">,</font> <font color=Green>Add</font> a <font color="#808080">(</font><font color=Green>AddTy</font> b c<font color="#808080">)</font><font color="#808080">)</font> <font color="#808080">=&gt;</font> 
  a <font color="#808080">-&gt;</font> b <font color="#808080">-&gt;</font> c <font color="#808080">-&gt;</font> <font color=Green>AddTy</font> a <font color="#808080">(</font><font color=Green>AddTy</font> b c<font color="#808080">)</font>
</pre>
</body>
</html>