<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>lectures/lecture11/Array.hs</title>
</head>
<body>
<pre><font color=Blue>{-# LANGUAGE TypeFamilies, GeneralizedNewtypeDeriving #-}</font>
<u><font color="#804000">module</font></u> <font color=Green>Array</font> <u><font color="#804000">where</font></u>

<font color=Blue>-- Some preliminaries (for stronger type checking)</font>
<u><font color="#804000">newtype</font></u> <font color=Green>Index</font> <font color="#808080">=</font> <font color=Green>Index</font> <font color="#808080">{</font>unIndex <font color="#808080">::</font> <font color=Green>Int</font><font color="#808080">}</font> 
  <u><font color="#804000">deriving</font></u> <font color="#808080">(</font><font color=Green>Num</font><font color="#808080">,</font> <font color=Green>Eq</font><font color="#808080">,</font> <font color=Green>ArrayElem</font><font color="#808080">,</font> <font color=Green>Ord</font><font color="#808080">,</font> <font color=Green>Enum</font><font color="#808080">)</font>

<u><font color="#804000">newtype</font></u> <font color=Green>Size</font>  <font color="#808080">=</font> <font color=Green>Size</font>  <font color="#808080">{</font>unSize  <font color="#808080">::</font> <font color=Green>Int</font><font color="#808080">}</font> 
  <u><font color="#804000">deriving</font></u> <font color="#808080">(</font><font color=Green>Num</font><font color="#808080">,</font> <font color=Green>Eq</font><font color="#808080">,</font> <font color=Green>ArrayElem</font><font color="#808080">)</font>

toIndex  <font color="#808080">::</font> <font color=Green>Size</font> <font color="#808080">-&gt;</font> <font color=Green>Index</font>
toIndex <font color="#808080">(</font><font color=Green>Size</font> n<font color="#808080">)</font> <font color="#808080">=</font> <font color=Green>Index</font> n

maxIndex <font color="#808080">::</font> <font color=Green>Size</font> <font color="#808080">-&gt;</font> <font color=Green>Index</font>
maxIndex n <font color="#808080">=</font> toIndex n <font color=Blue>-</font> <font color=Magenta>1</font>

toSize <font color="#808080">::</font> <font color=Green>Index</font> <font color="#808080">-&gt;</font> <font color=Green>Size</font>
toSize <font color="#808080">(</font><font color=Green>Index</font> i<font color="#808080">)</font> <font color="#808080">=</font> <font color=Green>Size</font> i

<font color=Blue>{- A type family is like a function on the type level where you
can pattern match on the type arguments. An important difference
is that it's /open/ which means that you can add more equations
to the function at any time.

In this example we will implement a type family of "efficient"
array implementations.

Type families are often used as "associated types" - a type
member in a class, much like the class methods are function
members of the class.  
-}</font>

<font color=Blue>-- The type signature for our family / associated datatype</font>
<u><font color="#804000">data</font></u> family <font color=Green>Array</font> a
<font color=Blue>-- The "family members" will be arrays of ints, pairs, and nested</font>
<font color=Blue>-- arrays.</font>

<font color=Blue>-- | A class of operations on the array family. We'll make one</font>
<font color=Blue>--   instance per clause in the definition of the family.</font>
<u><font color="#804000">class</font></u> <font color=Green>ArrayElem</font> a <u><font color="#804000">where</font></u>
  <font color="#808080">(</font><font color="#800080">!</font><font color="#808080">)</font>      <font color="#808080">::</font> <font color=Green>Array</font> a <font color="#808080">-&gt;</font> <font color=Green>Index</font> <font color="#808080">-&gt;</font> a
  <font color=Blue>-- | @slice a (i,n)@ is the slice of @a@ starting at </font>
  <font color=Blue>--   index @i@ with @n@ elements.</font>
  slice    <font color="#808080">::</font> <font color=Green>Array</font> a <font color="#808080">-&gt;</font> <font color="#808080">(</font><font color=Green>Index</font><font color="#808080">,</font> <font color=Green>Size</font><font color="#808080">)</font> <font color="#808080">-&gt;</font> <font color=Green>Array</font> a
  size     <font color="#808080">::</font> <font color=Green>Array</font> a <font color="#808080">-&gt;</font> <font color=Green>Size</font>
  fromList <font color="#808080">::</font> <font color="#808080">[</font>a<font color="#808080">]</font> <font color="#808080">-&gt;</font> <font color=Green>Array</font> a

<font color=Blue>-- | Converting an array to a list.</font>
toList <font color="#808080">::</font> <font color=Green>ArrayElem</font> a <font color="#808080">=&gt;</font> <font color=Green>Array</font> a <font color="#808080">-&gt;</font> <font color="#808080">[</font>a<font color="#808080">]</font>
toList a <font color="#808080">=</font> <font color="#808080">[</font> a <font color="#800080">!</font> i <font color="#808080">|</font> i <font color="#808080">&lt;-</font> <font color="#808080">[</font><font color=Magenta>0</font><font color="#808080">..</font>maxIndex <font color="#808080">(</font>size a<font color="#808080">)</font><font color="#808080">]</font> <font color="#808080">]</font>

<font color=Blue>----------------</font>
<font color=Blue>-- * Int arrays. </font>
<font color=Blue>-- | We cheat with the implementation of Int arrays to make</font>
<font color=Blue>-- implementations of the functions easy.</font>
<u><font color="#804000">type</font></u> <font color=Green>SuperEfficientByteArray</font> <font color="#808080">=</font> <font color="#808080">[</font><font color=Green>Int</font><font color="#808080">]</font> <font color=Blue>-- cheating</font>
<u><font color="#804000">newtype</font></u> <u><font color="#804000">instance</font></u> <font color=Green>Array</font> <font color=Green>Int</font>   <font color="#808080">=</font> <font color=Green>ArrInt</font> <font color=Green>SuperEfficientByteArray</font> 

<font color=Blue>-- | Here is a style of instance declaration which just binds</font>
<font color=Blue>-- names and delegates all the work to helper functions. This</font>
<font color=Blue>-- style makes the types of the instatiated member functions</font>
<font color=Blue>-- more visible which can help in documenting and developing the</font>
<font color=Blue>-- code. (Haskell does not allow type signatures in instance</font>
<font color=Blue>-- declarations.)</font>
<u><font color="#804000">instance</font></u> <font color=Green>ArrayElem</font> <font color=Green>Int</font> <u><font color="#804000">where</font></u>
  <font color="#808080">(</font><font color="#800080">!</font><font color="#808080">)</font>      <font color="#808080">=</font> indexInt
  slice    <font color="#808080">=</font> sliceInt
  size     <font color="#808080">=</font> sizeInt
  fromList <font color="#808080">=</font> fromListInt

indexInt <font color="#808080">::</font> <font color=Green>Array</font> <font color=Green>Int</font> <font color="#808080">-&gt;</font> <font color=Green>Index</font> <font color="#808080">-&gt;</font> <font color=Green>Int</font>
indexInt <font color="#808080">(</font><font color=Green>ArrInt</font> a<font color="#808080">)</font> <font color="#808080">(</font><font color=Green>Index</font> i<font color="#808080">)</font> <font color="#808080">=</font> a <font color="#800080">!!</font> i

sliceInt <font color="#808080">::</font> <font color=Green>Array</font> <font color=Green>Int</font> <font color="#808080">-&gt;</font> <font color="#808080">(</font><font color=Green>Index</font><font color="#808080">,</font> <font color=Green>Size</font><font color="#808080">)</font> <font color="#808080">-&gt;</font> <font color=Green>Array</font> <font color=Green>Int</font>
sliceInt <font color="#808080">(</font><font color=Green>ArrInt</font> a<font color="#808080">)</font> <font color="#808080">(</font><font color=Green>Index</font> i<font color="#808080">,</font> <font color=Green>Size</font> n<font color="#808080">)</font> <font color="#808080">=</font>
    <font color=Green>ArrInt</font> <font color="#808080">(</font>take n <font color="#808080">(</font>drop i a<font color="#808080">)</font><font color="#808080">)</font>

sizeInt  <font color="#808080">::</font> <font color=Green>Array</font> <font color=Green>Int</font> <font color="#808080">-&gt;</font> <font color=Green>Size</font>
sizeInt <font color="#808080">(</font><font color=Green>ArrInt</font> a<font color="#808080">)</font> <font color="#808080">=</font> <font color=Green>Size</font> <font color="#808080">(</font>length a<font color="#808080">)</font>

fromListInt <font color="#808080">::</font> <font color="#808080">[</font><font color=Green>Int</font><font color="#808080">]</font> <font color="#808080">-&gt;</font> <font color=Green>Array</font> <font color=Green>Int</font>
fromListInt <font color="#808080">=</font> <font color=Green>ArrInt</font>

<font color=Blue>----------------</font>
<font color=Blue>-- Arrays of Sizes or Indices are just the same as arrays of ints</font>
<u><font color="#804000">newtype</font></u> <u><font color="#804000">instance</font></u> <font color=Green>Array</font> <font color=Green>Size</font>  <font color="#808080">=</font> <font color=Green>ArrSize</font>  <font color="#808080">(</font><font color=Green>Array</font> <font color=Green>Int</font><font color="#808080">)</font>
<u><font color="#804000">newtype</font></u> <u><font color="#804000">instance</font></u> <font color=Green>Array</font> <font color=Green>Index</font> <font color="#808080">=</font> <font color=Green>ArrIndex</font> <font color="#808080">(</font><font color=Green>Array</font> <font color=Green>Int</font><font color="#808080">)</font>
<font color=Blue>-- instance declarations are derived at the definition of Size and</font>
<font color=Blue>-- Index</font>

<font color=Blue>----------------</font>
<font color=Blue>-- | Arrays of pairs are pairs of arrays. Mostly just lifting</font>
<font color=Blue>-- the operations to work on pairs.</font>
<u><font color="#804000">newtype</font></u> <u><font color="#804000">instance</font></u> <font color=Green>Array</font> <font color="#808080">(</font>a<font color="#808080">,</font> b<font color="#808080">)</font> <font color="#808080">=</font> <font color=Green>ArrPair</font> <font color="#808080">(</font><font color=Green>Array</font> a<font color="#808080">,</font> <font color=Green>Array</font> b<font color="#808080">)</font>

<font color=Blue>{-

-- This is a working and short definition, which may be
-- preferrable as the end result, but which may be difficult to
-- read and understand if you are not used to Haskell.

instance (ArrayElem a, ArrayElem b) =&gt; ArrayElem (a, b) where
  ArrPair (as, bs) ! i = (as ! i, bs ! i)

  slice (ArrPair (as, bs)) (i, n) =
    ArrPair (slice as (i, n), slice bs (i, n))

  size (ArrPair (as, _)) = size as

  fromList xs = ArrPair (fromList as, fromList bs)
    where (as, bs) = unzip xs
-}</font>

<font color=Blue>-- | This is the expanded version showing all the types</font>
<u><font color="#804000">instance</font></u> <font color="#808080">(</font><font color=Green>ArrayElem</font> a<font color="#808080">,</font> <font color=Green>ArrayElem</font> b<font color="#808080">)</font> <font color="#808080">=&gt;</font> <font color=Green>ArrayElem</font> <font color="#808080">(</font>a<font color="#808080">,</font> b<font color="#808080">)</font> <u><font color="#804000">where</font></u>
  <font color="#808080">(</font><font color="#800080">!</font><font color="#808080">)</font>      <font color="#808080">=</font> indexPair
  slice    <font color="#808080">=</font> slicePair
  size     <font color="#808080">=</font> sizePair
  fromList <font color="#808080">=</font> fromListPair

indexPair <font color="#808080">::</font> <font color="#808080">(</font><font color=Green>ArrayElem</font> a<font color="#808080">,</font> <font color=Green>ArrayElem</font> b<font color="#808080">)</font> <font color="#808080">=&gt;</font> 
  <font color=Green>Array</font> <font color="#808080">(</font>a<font color="#808080">,</font> b<font color="#808080">)</font> <font color="#808080">-&gt;</font> <font color=Green>Index</font> <font color="#808080">-&gt;</font> <font color="#808080">(</font>a<font color="#808080">,</font> b<font color="#808080">)</font>
indexPair <font color="#808080">(</font><font color=Green>ArrPair</font> <font color="#808080">(</font><u><font color="#804000">as</font></u><font color="#808080">,</font> bs<font color="#808080">)</font><font color="#808080">)</font> i <font color="#808080">=</font> <font color="#808080">(</font><u><font color="#804000">as</font></u> <font color="#800080">!</font> i<font color="#808080">,</font> bs <font color="#800080">!</font> i<font color="#808080">)</font>

slicePair <font color="#808080">::</font> <font color="#808080">(</font><font color=Green>ArrayElem</font> a<font color="#808080">,</font> <font color=Green>ArrayElem</font> b<font color="#808080">)</font> <font color="#808080">=&gt;</font>
  <font color=Green>Array</font> <font color="#808080">(</font>a<font color="#808080">,</font> b<font color="#808080">)</font> <font color="#808080">-&gt;</font> <font color="#808080">(</font><font color=Green>Index</font><font color="#808080">,</font> <font color=Green>Size</font><font color="#808080">)</font> <font color="#808080">-&gt;</font> <font color=Green>Array</font> <font color="#808080">(</font>a<font color="#808080">,</font> b<font color="#808080">)</font>
slicePair <font color="#808080">(</font><font color=Green>ArrPair</font> <font color="#808080">(</font><u><font color="#804000">as</font></u><font color="#808080">,</font> bs<font color="#808080">)</font><font color="#808080">)</font> <font color="#808080">(</font>i<font color="#808080">,</font> n<font color="#808080">)</font> <font color="#808080">=</font>
  <font color=Green>ArrPair</font> <font color="#808080">(</font>slice <u><font color="#804000">as</font></u> <font color="#808080">(</font>i<font color="#808080">,</font> n<font color="#808080">)</font><font color="#808080">,</font> slice bs <font color="#808080">(</font>i<font color="#808080">,</font> n<font color="#808080">)</font><font color="#808080">)</font>

sizePair <font color="#808080">::</font> <font color=Green>ArrayElem</font> a <font color="#808080">=&gt;</font> <font color=Green>Array</font> <font color="#808080">(</font>a<font color="#808080">,</font> b<font color="#808080">)</font> <font color="#808080">-&gt;</font> <font color=Green>Size</font>
sizePair <font color="#808080">(</font><font color=Green>ArrPair</font> <font color="#808080">(</font><u><font color="#804000">as</font></u><font color="#808080">,</font> <u><font color="#804000">_</font></u><font color="#808080">)</font><font color="#808080">)</font> <font color="#808080">=</font> size <u><font color="#804000">as</font></u>

fromListPair <font color="#808080">::</font> <font color="#808080">(</font><font color=Green>ArrayElem</font> a<font color="#808080">,</font> <font color=Green>ArrayElem</font> b<font color="#808080">)</font> <font color="#808080">=&gt;</font> 
  <font color="#808080">[</font><font color="#808080">(</font>a<font color="#808080">,</font> b<font color="#808080">)</font><font color="#808080">]</font> <font color="#808080">-&gt;</font> <font color=Green>Array</font> <font color="#808080">(</font>a<font color="#808080">,</font> b<font color="#808080">)</font>
fromListPair xs <font color="#808080">=</font> <font color=Green>ArrPair</font> <font color="#808080">(</font>fromList <u><font color="#804000">as</font></u><font color="#808080">,</font> fromList bs<font color="#808080">)</font>
    <u><font color="#804000">where</font></u> <font color="#808080">(</font><u><font color="#804000">as</font></u><font color="#808080">,</font> bs<font color="#808080">)</font> <font color="#808080">=</font> unzip xs

<font color=Blue>-- | Nested arrays. Here we have to work a little bit.  A nested</font>
<font color=Blue>-- array is implemented as a flat array together with an array</font>
<font color=Blue>-- of offsets (indices) and sizes of the subarrays.</font>
<u><font color="#804000">data</font></u> <u><font color="#804000">instance</font></u> <font color=Green>Array</font> <font color="#808080">(</font><font color=Green>Array</font> a<font color="#808080">)</font> <font color="#808080">=</font> <font color=Green>ArrNested</font> <font color="#808080">(</font><font color=Green>Array</font> a<font color="#808080">)</font> 
                                          <font color="#808080">(</font><font color=Green>Array</font> <font color="#808080">(</font><font color=Green>Index</font><font color="#808080">,</font> <font color=Green>Size</font><font color="#808080">)</font><font color="#808080">)</font>

<font color=Blue>-- Exercise: what invariant must hold for this to work?</font>
<font color=Blue>-- Implement a property checking it.</font>

<u><font color="#804000">instance</font></u> <font color=Green>ArrayElem</font> a <font color="#808080">=&gt;</font> <font color=Green>ArrayElem</font> <font color="#808080">(</font><font color=Green>Array</font> a<font color="#808080">)</font> <u><font color="#804000">where</font></u>
  <font color="#808080">(</font><font color="#800080">!</font><font color="#808080">)</font>      <font color="#808080">=</font> indexNested
  slice    <font color="#808080">=</font> sliceNested
  size     <font color="#808080">=</font> sizeNested
  fromList <font color="#808080">=</font> fromListNested

<font color=Blue>-- Indexing is just slicing the flat array.</font>
indexNested <font color="#808080">::</font> <font color="#808080">(</font><font color=Green>ArrayElem</font> a<font color="#808080">)</font> <font color="#808080">=&gt;</font> 
  <font color=Green>Array</font> <font color="#808080">(</font><font color=Green>Array</font> a<font color="#808080">)</font> <font color="#808080">-&gt;</font> <font color=Green>Index</font> <font color="#808080">-&gt;</font> <font color=Green>Array</font> a
indexNested <font color="#808080">(</font><font color=Green>ArrNested</font> <u><font color="#804000">as</font></u> segs<font color="#808080">)</font> i <font color="#808080">=</font> slice <u><font color="#804000">as</font></u> <font color="#808080">(</font>segs <font color="#800080">!</font> i<font color="#808080">)</font>

<font color=Blue>-- | Slicing is slicing the flat array and the segment array,</font>
<font color=Blue>-- but we have to do some work to figure out how to slice the</font>
<font color=Blue>-- flat array.</font>
sliceNested <font color="#808080">::</font> <font color="#808080">(</font><font color=Green>ArrayElem</font> a<font color="#808080">)</font> <font color="#808080">=&gt;</font>
  <font color=Green>Array</font> <font color="#808080">(</font><font color=Green>Array</font> a<font color="#808080">)</font> <font color="#808080">-&gt;</font> <font color="#808080">(</font><font color=Green>Index</font><font color="#808080">,</font> <font color=Green>Size</font><font color="#808080">)</font> <font color="#808080">-&gt;</font> <font color=Green>Array</font> <font color="#808080">(</font><font color=Green>Array</font> a<font color="#808080">)</font>
sliceNested <font color="#808080">(</font><font color=Green>ArrNested</font> <u><font color="#804000">as</font></u> segs<font color="#808080">)</font> <font color="#808080">(</font>i<font color="#808080">,</font> n<font color="#808080">)</font> <font color="#808080">=</font>
  <font color=Green>ArrNested</font> <font color="#808080">(</font>slice <u><font color="#804000">as</font></u>   <font color="#808080">(</font>j<font color="#808080">,</font> m<font color="#808080">)</font><font color="#808080">)</font> 
            <font color="#808080">(</font>fixInvariant <font color="#800080">$</font> slice segs <font color="#808080">(</font>i<font color="#808080">,</font> n<font color="#808080">)</font><font color="#808080">)</font>
  <u><font color="#804000">where</font></u>
    fixInvariant <font color="#808080">=</font> fromList <font color="#800080">.</font> map <font color="#808080">(</font>mapFst <font color="#808080">(</font><font color="#808080">(</font><font color=Blue>-</font>j<font color="#808080">)</font><font color="#800080">+</font><font color="#808080">)</font><font color="#808080">)</font> <font color="#800080">.</font> toList
    <font color="#808080">(</font>j<font color="#808080">,</font> <u><font color="#804000">_</font></u><font color="#808080">)</font> <font color="#808080">=</font> segs <font color="#800080">!</font> i
    m      <font color="#808080">=</font> sum <font color="#808080">[</font> snd <font color="#808080">(</font>segs <font color="#800080">!</font> k<font color="#808080">)</font> <font color=Blue>-- second components store sizes</font>
                 <font color="#808080">|</font> k <font color="#808080">&lt;-</font> <font color="#808080">[</font>i<font color="#808080">..</font>n'<font color=Blue>-</font><font color=Magenta>1</font><font color="#808080">]</font> <font color="#808080">]</font>
    n' <font color="#808080">=</font> min <font color="#808080">(</font>i<font color="#800080">+</font>toIndex n<font color="#808080">)</font> <font color="#808080">(</font>toIndex <font color="#800080">$</font> size segs<font color="#808080">)</font> 
         <font color=Blue>-- don't look too far</font>
<font color=Blue>-- Exercise: Refactor to avoid summing - something like </font>
<font color=Blue>--    m' = toSize (fst (segs ! (i + toIndex n))  - j)</font>

mapFst <font color="#808080">::</font> <font color="#808080">(</font>a<font color="#808080">-&gt;</font>a'<font color="#808080">)</font> <font color="#808080">-&gt;</font> <font color="#808080">(</font>a<font color="#808080">,</font> b<font color="#808080">)</font> <font color="#808080">-&gt;</font> <font color="#808080">(</font>a'<font color="#808080">,</font> b<font color="#808080">)</font>
mapFst       f       <font color="#808080">(</font>a<font color="#808080">,</font> b<font color="#808080">)</font> <font color="#808080">=</font> <font color="#808080">(</font>f a<font color="#808080">,</font> b<font color="#808080">)</font>
         

sizeNested <font color="#808080">::</font> <font color=Green>Array</font> <font color="#808080">(</font><font color=Green>Array</font> a<font color="#808080">)</font> <font color="#808080">-&gt;</font> <font color=Green>Size</font>
sizeNested <font color="#808080">(</font><font color=Green>ArrNested</font> <u><font color="#804000">_</font></u> segs<font color="#808080">)</font> <font color="#808080">=</font> size segs

<font color=Blue>-- Creating the flat array isn't very nicely done. We shouldn't</font>
<font color=Blue>-- have to convert our arrays back to lists to do it.  Solution</font>
<font color=Blue>-- (exercise): add a concatenation operation on arrays.</font>
fromListNested <font color="#808080">::</font> <font color="#808080">(</font><font color=Green>ArrayElem</font> a<font color="#808080">)</font> <font color="#808080">=&gt;</font> <font color="#808080">[</font><font color=Green>Array</font> a<font color="#808080">]</font> <font color="#808080">-&gt;</font> <font color=Green>Array</font> <font color="#808080">(</font><font color=Green>Array</font> a<font color="#808080">)</font>
fromListNested xss <font color="#808080">=</font> 
    <font color=Green>ArrNested</font> <font color="#808080">(</font>fromList <font color="#800080">$</font> concatMap toList xss<font color="#808080">)</font> <font color=Blue>-- Bad!</font>
              <font color="#808080">(</font>fromList <font color="#800080">$</font> tail <font color="#800080">$</font> scanl seg <font color="#808080">(</font><font color=Magenta>0</font><font color="#808080">,</font><font color=Magenta>0</font><font color="#808080">)</font> xss<font color="#808080">)</font>
  <u><font color="#804000">where</font></u> seg <font color="#808080">(</font>i<font color="#808080">,</font> n<font color="#808080">)</font> a <font color="#808080">=</font> <font color="#808080">(</font>i <font color="#800080">+</font> toIndex n<font color="#808080">,</font> size a<font color="#808080">)</font>

<font color=Blue>----------------------------------------------------------------</font>

<u><font color="#804000">instance</font></u> <font color=Green>Show</font> <font color=Green>Size</font>  <u><font color="#804000">where</font></u> 
  showsPrec p <font color="#808080">(</font><font color=Green>Size</font> n<font color="#808080">)</font>  <font color="#808080">=</font> showParen <font color="#808080">(</font>p <font color="#800080">&gt;</font> <font color=Magenta>0</font><font color="#808080">)</font> <font color="#800080">$</font>
    showString <font color=Magenta>"Size "</font> <font color="#800080">.</font> showsPrec <font color=Magenta>1</font> n
<u><font color="#804000">instance</font></u> <font color=Green>Show</font> <font color=Green>Index</font> <u><font color="#804000">where</font></u> 
  showsPrec p <font color="#808080">(</font><font color=Green>Index</font> n<font color="#808080">)</font> <font color="#808080">=</font> showParen <font color="#808080">(</font>p <font color="#800080">&gt;</font> <font color=Magenta>0</font><font color="#808080">)</font> <font color="#800080">$</font>
    showString <font color=Magenta>"Index "</font> <font color="#800080">.</font> showsPrec <font color=Magenta>1</font> n
</pre>
</body>
</html>