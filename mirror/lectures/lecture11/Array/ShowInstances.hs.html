<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>lectures/lecture7/Array/ShowInstances.hs</title>
</head>
<body>
<pre><font color=Blue>{-# LANGUAGE FlexibleInstances, FlexibleContexts #-}</font>
<u><font color="#804000">module</font></u> <font color=Green>Array</font><font color="#800080">.</font><font color=Green>ShowInstances</font> <u><font color="#804000">where</font></u>
<u><font color="#804000">import</font></u> <font color=Green>Array</font>

<font color=Blue>-- Show instances, just so we can see how the implementation works.</font>
<u><font color="#804000">instance</font></u> <font color=Green>Show</font> <font color="#808080">(</font><font color=Green>Array</font> <font color=Green>Int</font><font color="#808080">)</font> <u><font color="#804000">where</font></u>
  showsPrec p <font color="#808080">(</font><font color=Green>ArrInt</font> a<font color="#808080">)</font> <font color="#808080">=</font> showParen <font color="#808080">(</font>p <font color="#800080">&gt;</font> <font color=Magenta>0</font><font color="#808080">)</font> <font color="#800080">$</font> 
    showString <font color=Magenta>"ArrInt "</font> <font color="#800080">.</font> showsPrec <font color=Magenta>1</font> a

<u><font color="#804000">instance</font></u> <font color=Green>Show</font> <font color="#808080">(</font><font color=Green>Array</font> <font color=Green>Size</font><font color="#808080">)</font> <u><font color="#804000">where</font></u>
  showsPrec p <font color="#808080">(</font><font color=Green>ArrSize</font> a<font color="#808080">)</font> <font color="#808080">=</font> showParen <font color="#808080">(</font>p <font color="#800080">&gt;</font> <font color=Magenta>0</font><font color="#808080">)</font> <font color="#800080">$</font> 
    showString <font color=Magenta>"ArrSize "</font> <font color="#800080">.</font> showsPrec <font color=Magenta>1</font> a

<u><font color="#804000">instance</font></u> <font color=Green>Show</font> <font color="#808080">(</font><font color=Green>Array</font> <font color=Green>Index</font><font color="#808080">)</font> <u><font color="#804000">where</font></u>
  showsPrec p <font color="#808080">(</font><font color=Green>ArrIndex</font> a<font color="#808080">)</font> <font color="#808080">=</font> showParen <font color="#808080">(</font>p <font color="#800080">&gt;</font> <font color=Magenta>0</font><font color="#808080">)</font> <font color="#800080">$</font>
    showString <font color=Magenta>"ArrIndex "</font> <font color="#800080">.</font> showsPrec <font color=Magenta>1</font> a

<u><font color="#804000">instance</font></u> <font color="#808080">(</font><font color=Green>Show</font> <font color="#808080">(</font><font color=Green>Array</font> a<font color="#808080">)</font><font color="#808080">,</font> <font color=Green>Show</font> <font color="#808080">(</font><font color=Green>Array</font> b<font color="#808080">)</font><font color="#808080">)</font> <font color="#808080">=&gt;</font> <font color=Green>Show</font> <font color="#808080">(</font><font color=Green>Array</font> <font color="#808080">(</font>a<font color="#808080">,</font> b<font color="#808080">)</font><font color="#808080">)</font> <u><font color="#804000">where</font></u>
  showsPrec p <font color="#808080">(</font><font color=Green>ArrPair</font> <font color="#808080">(</font><u><font color="#804000">as</font></u><font color="#808080">,</font> bs<font color="#808080">)</font><font color="#808080">)</font> <font color="#808080">=</font> showParen <font color="#808080">(</font>p <font color="#800080">&gt;</font> <font color=Magenta>0</font><font color="#808080">)</font> <font color="#800080">$</font>
    showString <font color=Magenta>"ArrPair "</font> <font color="#800080">.</font> showsPrec <font color=Magenta>1</font> <font color="#808080">(</font><u><font color="#804000">as</font></u><font color="#808080">,</font> bs<font color="#808080">)</font>

<u><font color="#804000">instance</font></u> <font color=Green>Show</font> <font color="#808080">(</font><font color=Green>Array</font> a<font color="#808080">)</font> <font color="#808080">=&gt;</font> <font color=Green>Show</font> <font color="#808080">(</font><font color=Green>Array</font> <font color="#808080">(</font><font color=Green>Array</font> a<font color="#808080">)</font><font color="#808080">)</font> <u><font color="#804000">where</font></u>
  showsPrec p <font color="#808080">(</font><font color=Green>ArrNested</font> <u><font color="#804000">as</font></u> segs<font color="#808080">)</font> <font color="#808080">=</font> showParen <font color="#808080">(</font>p <font color="#800080">&gt;</font> <font color=Magenta>0</font><font color="#808080">)</font> <font color="#800080">$</font>
    showString <font color=Magenta>"ArrNested "</font> <font color="#800080">.</font> showsPrec <font color=Magenta>1</font> <u><font color="#804000">as</font></u> <font color="#800080">.</font> showString <font color=Magenta>" "</font> 
                            <font color="#800080">.</font> showsPrec <font color=Magenta>1</font> segs
</pre>
</body>
</html>