<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>lectures/lecture2/Shape.hs</title>
</head>
<body>
<pre><font color=Blue>-- | Simple library for 2D shapes.</font>
<u><font color="#804000">module</font></u> <font color=Green>Shape</font>
  <font color="#808080">(</font> <u><font color="#804000">module</font></u> <font color=Green>ShapeImpl</font>
  <font color="#808080">,</font> <u><font color="#804000">module</font></u> <font color=Green>Shape</font>
  <font color="#808080">,</font> <u><font color="#804000">module</font></u> <font color=Green>Matrix</font>
  <font color="#808080">)</font> <u><font color="#804000">where</font></u>

<u><font color="#804000">import</font></u> <font color=Green>Matrix</font>
<font color=Blue>-- import Shape.Shallow as ShapeImpl</font>
<u><font color="#804000">import</font></u> <font color=Green>Shape</font><font color="#800080">.</font><font color=Green>Deep</font> <u><font color="#804000">as</font></u> <font color=Green>ShapeImpl</font>

<font color=Blue>-- | Derived combinators</font>

scale <font color="#808080">::</font> <font color=Green>Vec</font> <font color="#808080">-&gt;</font> <font color=Green>Shape</font> <font color="#808080">-&gt;</font> <font color=Green>Shape</font>
scale v <font color="#808080">=</font> transform <font color="#808080">(</font>matrix  <font color="#808080">(</font>vecX v<font color="#808080">)</font>  <font color=Magenta>0</font> 
                             <font color=Magenta>0</font>         <font color="#808080">(</font>vecY v<font color="#808080">)</font><font color="#808080">)</font>

rotate <font color="#808080">::</font> <font color=Green>Angle</font> <font color="#808080">-&gt;</font> <font color=Green>Shape</font> <font color="#808080">-&gt;</font> <font color=Green>Shape</font>
rotate d <font color="#808080">=</font> transform <font color="#808080">(</font>matrix  c  <font color="#808080">(</font><font color=Blue>-</font>s<font color="#808080">)</font> 
                              s  c   <font color="#808080">)</font>
  <u><font color="#804000">where</font></u>  c <font color="#808080">=</font> cos d
         s <font color="#808080">=</font> sin d

difference <font color="#808080">::</font> <font color=Green>Shape</font> <font color="#808080">-&gt;</font> <font color=Green>Shape</font> <font color="#808080">-&gt;</font> <font color=Green>Shape</font>
difference sh1 sh2 <font color="#808080">=</font> sh1 <font color="#800080">`intersect`</font> invert sh2
</pre>
</body>
</html>