<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>lectures/lecture2/Animate.hs</title>
</head>
<body>
<pre><font color=Blue>-- | Combining 'Signal' and 'Shape' to obtain moving objects.</font>
<u><font color="#804000">module</font></u> <font color=Green>Animate</font> <u><font color="#804000">where</font></u>

<u><font color="#804000">import</font></u> <font color=Green>System</font><font color="#800080">.</font><font color=Green>Posix</font> <font color="#808080">(</font>usleep<font color="#808080">)</font>

<u><font color="#804000">import</font></u> <font color=Green>Signal</font>
<u><font color="#804000">import</font></u> <font color=Green>Shape</font>
<u><font color="#804000">import</font></u> <font color=Green>Render</font>
<u><font color="#804000">import</font></u> <font color=Green>ANSI</font>

fps <font color="#808080">=</font> <font color=Magenta>10</font>   <font color=Blue>-- we generate 10 fps</font>

<font color=Blue>-- | Animate a shape valued signal.</font>
animate <font color="#808080">::</font> <font color=Green>Window</font> <font color="#808080">-&gt;</font> <font color=Green>Time</font> <font color="#808080">-&gt;</font> <font color=Green>Time</font> <font color="#808080">-&gt;</font> <font color=Green>Signal</font> <font color=Green>Shape</font> <font color="#808080">-&gt;</font> <font color=Green>IO</font> <font color=Green>()</font>
animate win t0 t1 ss <font color="#808080">=</font> mapM_ display frames
  <u><font color="#804000">where</font></u>
    ts     <font color="#808080">=</font> samples t0 t1 <font color="#808080">(</font>round <font color="#800080">$</font> <font color="#808080">(</font>t1 <font color=Blue>-</font> t0<font color="#808080">)</font> <font color="#800080">*</font> fps<font color="#808080">)</font>
    frames <font color="#808080">=</font> map <font color="#808080">(</font>sample ss<font color="#808080">)</font> ts

    display sh <font color="#808080">=</font> <u><font color="#804000">do</font></u>
      putStr <font color="#800080">$</font> ansiClearScreen <font color="#800080">++</font> ansiGoto <font color=Magenta>1</font> <font color=Magenta>1</font> <font color="#800080">++</font> render win sh
      usleep <font color=Magenta>70000</font>  <font color=Blue>-- sleeping removes flickering</font>

</pre>
</body>
</html>