<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>lectures/lecture2/Signal/Deep.hs</title>
</head>
<body>
<pre><font color=Blue>{-# LANGUAGE GADTs #-}</font>
<font color=Blue>-- | A very simple library for manipulating continuous signals. Deep embedding.</font>
<u><font color="#804000">module</font></u> <font color=Green>Signal</font><font color="#800080">.</font><font color=Green>Deep</font>
  <font color="#808080">(</font> <font color=Green>Time</font>
  <font color=Blue>-- | the 'Signal' type is abstract</font>
  <font color="#808080">,</font> <font color=Green>Signal</font>  
  <font color=Blue>-- * Smart constructors</font>
  <font color="#808080">,</font> constS<font color="#808080">,</font> timeS
  <font color=Blue>-- * Combinators</font>
  <font color="#808080">,</font> <font color="#808080">(</font><font color="#800080">$$</font><font color="#808080">)</font><font color="#808080">,</font> mapT
  <font color=Blue>-- * Derived operation</font>
  <font color="#808080">,</font> mapS
  <font color=Blue>-- * Run function</font>
  <font color="#808080">,</font> sample
  <font color="#808080">)</font> <u><font color="#804000">where</font></u>

<font color=Blue>-- * Smart constructors</font>
constS <font color="#808080">::</font> a <font color="#808080">-&gt;</font> <font color=Green>Signal</font> a
timeS  <font color="#808080">::</font>      <font color=Green>Signal</font> <font color=Green>Time</font>
<font color=Blue>-- * Combinators</font>
<font color="#808080">(</font><font color="#800080">$$</font><font color="#808080">)</font>   <font color="#808080">::</font> <font color=Green>Signal</font> <font color="#808080">(</font>a <font color="#808080">-&gt;</font> b<font color="#808080">)</font> <font color="#808080">-&gt;</font> <font color=Green>Signal</font> a <font color="#808080">-&gt;</font> <font color=Green>Signal</font> b
mapT   <font color="#808080">::</font> <font color="#808080">(</font><font color=Green>Time</font> <font color="#808080">-&gt;</font> <font color=Green>Time</font><font color="#808080">)</font>  <font color="#808080">-&gt;</font> <font color=Green>Signal</font> a <font color="#808080">-&gt;</font> <font color=Green>Signal</font> a
<font color=Blue>-- * Derived operation</font>
mapS   <font color="#808080">::</font> <font color="#808080">(</font>a <font color="#808080">-&gt;</font> b<font color="#808080">)</font>        <font color="#808080">-&gt;</font> <font color=Green>Signal</font> a <font color="#808080">-&gt;</font> <font color=Green>Signal</font> b
<font color=Blue>-- * Run function</font>
sample <font color="#808080">::</font> <font color=Green>Signal</font> a <font color="#808080">-&gt;</font> <font color=Green>Time</font> <font color="#808080">-&gt;</font> a  

<u><font color="#804000">type</font></u> <font color=Green>Time</font> <font color="#808080">=</font> <font color=Green>Double</font>
<u><font color="#804000">data</font></u> <font color=Green>Signal</font> a <u><font color="#804000">where</font></u>
  <font color=Green>ConstS</font> <font color="#808080">::</font> a <font color="#808080">-&gt;</font> <font color=Green>Signal</font> a
  <font color=Green>TimeS</font>  <font color="#808080">::</font> <font color=Green>Signal</font> <font color=Green>Time</font>
  <font color=Green>MapT</font>   <font color="#808080">::</font> <font color="#808080">(</font><font color=Green>Time</font> <font color="#808080">-&gt;</font> <font color=Green>Time</font><font color="#808080">)</font> <font color="#808080">-&gt;</font> <font color=Green>Signal</font> a <font color="#808080">-&gt;</font> <font color=Green>Signal</font> a
  <font color="#808080">(</font><b><font color="#800080">:$$</font></b><font color="#808080">)</font>  <font color="#808080">::</font> <font color=Green>Signal</font> <font color="#808080">(</font>a <font color="#808080">-&gt;</font> b<font color="#808080">)</font> <font color="#808080">-&gt;</font> <font color=Green>Signal</font> a <font color="#808080">-&gt;</font> <font color=Green>Signal</font> b

<font color=Blue>-- | The constant signal.</font>
constS <font color="#808080">=</font> <font color=Green>ConstS</font>
<font color=Blue>-- | This definition is Eta-equivalent to</font>
<font color=Blue>-- &gt; constS x = ConstS x</font>

<font color=Blue>-- | The time signal</font>
timeS <font color="#808080">=</font> <font color=Green>TimeS</font>

<font color=Blue>-- | Function application lifted to signals.</font>
fs <font color="#800080">$$</font> xs <font color="#808080">=</font> fs <b><font color="#800080">:$$</font></b> xs

<font color=Blue>-- | Mapping a function over a signal.</font>
mapS f xs <font color="#808080">=</font> constS f <font color="#800080">$$</font> xs

<font color=Blue>-- | Transforming the time.</font>
mapT <font color="#808080">=</font> <font color=Green>MapT</font>

<font color=Blue>-- | Sampling a signal at a given time point.</font>
sample <font color="#808080">(</font><font color=Green>ConstS</font> x<font color="#808080">)</font>  <font color="#808080">=</font> const x
sample <font color=Green>TimeS</font>       <font color="#808080">=</font> id
sample <font color="#808080">(</font>f <b><font color="#800080">:$$</font></b> s<font color="#808080">)</font>   <font color="#808080">=</font> <font color="#808080">\</font>t <font color="#808080">-&gt;</font> sample f t <font color="#800080">$</font> sample s t
sample <font color="#808080">(</font><font color=Green>MapT</font> f s<font color="#808080">)</font>  <font color="#808080">=</font> sample s <font color="#800080">.</font> f
</pre>
</body>
</html>