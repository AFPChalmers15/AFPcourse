<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>lectures/lecture3/Coord.hs</title>
</head>
<body>
<pre><u><font color="#804000">module</font></u> <font color=Green>Coord</font> <u><font color="#804000">where</font></u>

<font color=Blue>-- | A screen coordinate is just a pair of integers (x,y).</font>
<u><font color="#804000">type</font></u> <font color=Green>Coord</font> <font color="#808080">=</font> <font color="#808080">(</font><font color=Green>Int</font><font color="#808080">,</font> <font color=Green>Int</font><font color="#808080">)</font>

<font color=Blue>-- | Directions.</font>
<u><font color="#804000">data</font></u> <font color=Green>Dir</font> <font color="#808080">=</font> <font color=Green>North</font> <font color="#808080">|</font> <font color=Green>East</font> <font color="#808080">|</font> <font color=Green>South</font> <font color="#808080">|</font> <font color=Green>West</font>
  <u><font color="#804000">deriving</font></u> <font color="#808080">(</font><font color=Green>Eq</font><font color="#808080">,</font> <font color=Green>Show</font><font color="#808080">,</font> <font color=Green>Enum</font><font color="#808080">)</font>

<font color=Blue>-- | Compute the adjacent coordinate in a given direction.</font>
movePos <font color="#808080">::</font> <font color=Green>Coord</font> <font color="#808080">-&gt;</font> <font color=Green>Dir</font> <font color="#808080">-&gt;</font> <font color=Green>Coord</font>
movePos <font color="#808080">(</font>x<font color="#808080">,</font> y<font color="#808080">)</font> d <font color="#808080">=</font> <u><font color="#804000">case</font></u> d <u><font color="#804000">of</font></u>
  <font color=Green>North</font> <font color="#808080">-&gt;</font> <font color="#808080">(</font>x<font color="#808080">,</font>      y <font color=Blue>-</font> <font color=Magenta>1</font><font color="#808080">)</font>
  <font color=Green>East</font>  <font color="#808080">-&gt;</font> <font color="#808080">(</font>x <font color="#800080">+</font> <font color=Magenta>1</font><font color="#808080">,</font>  y<font color="#808080">)</font>
  <font color=Green>South</font> <font color="#808080">-&gt;</font> <font color="#808080">(</font>x<font color="#808080">,</font>      y <font color="#800080">+</font> <font color=Magenta>1</font><font color="#808080">)</font>
  <font color=Green>West</font>  <font color="#808080">-&gt;</font> <font color="#808080">(</font>x <font color=Blue>-</font> <font color=Magenta>1</font><font color="#808080">,</font>  y<font color="#808080">)</font>

outOfBounds <font color="#808080">::</font> <font color=Green>Coord</font> <font color="#808080">-&gt;</font> <font color=Green>Bool</font>
outOfBounds <font color="#808080">(</font>x<font color="#808080">,</font>y<font color="#808080">)</font> <font color="#808080">=</font> x<font color="#800080">&lt;</font><font color=Magenta>0</font> <font color="#800080">||</font> y<font color="#800080">&lt;</font><font color=Magenta>0</font>
<font color=Blue>-- could also check some maximum x and y</font>
</pre>
</body>
</html>