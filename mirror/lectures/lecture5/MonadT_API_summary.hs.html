<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>lectures/lecture5/MonadT_API_summary.hs</title>
</head>
<body>
<pre><font color=Blue>-- Monad Transformer Summary (Lecture 5, AFP 2014)</font>
<font color=Blue>--   Patrik Jansson, Chalmers and U. of Gothenburg</font>
<font color=Blue>-- (This is not a complete Haskell file)</font>

<font color=Blue>----------------------------------------------------------------</font>
<font color=Blue>-- Functors and Monads (repetition)</font>
<u><font color="#804000">class</font></u> <font color=Green>Functor</font> f <u><font color="#804000">where</font></u>
  fmap <font color="#808080">::</font> <font color="#808080">(</font>a <font color="#808080">-&gt;</font> b<font color="#808080">)</font> <font color="#808080">-&gt;</font> <font color="#808080">(</font>f a <font color="#808080">-&gt;</font> f b<font color="#808080">)</font>

  <font color=Blue>-- Law.Id:  fmap id       ==  id</font>
  <font color=Blue>-- Law.Cmp: fmap (f . g)  ==  fmap f . fmap g</font>

<u><font color="#804000">class</font></u> <font color=Blue>{- Functor m =&gt; -}</font> <font color=Green>Monad</font> m <u><font color="#804000">where</font></u>
  <font color="#808080">(</font><font color="#800080">&gt;&gt;=</font><font color="#808080">)</font>  <font color="#808080">::</font> m a <font color="#808080">-&gt;</font> <font color="#808080">(</font>a <font color="#808080">-&gt;</font> m b<font color="#808080">)</font> <font color="#808080">-&gt;</font> m b
  <font color="#808080">(</font><font color="#800080">&gt;&gt;</font><font color="#808080">)</font>   <font color="#808080">::</font> m a <font color="#808080">-&gt;</font>       m b  <font color="#808080">-&gt;</font> m b
  return <font color="#808080">::</font> a                 <font color="#808080">-&gt;</font> m a
  fail   <font color="#808080">::</font> <font color=Green>String</font>            <font color="#808080">-&gt;</font> m a

  <font color=Blue>-- Law 1.  return x &gt;&gt;= f   ==  f x</font>
  <font color=Blue>-- Law 2.  m &gt;&gt;= return     ==  m</font>
  <font color=Blue>-- Law 3.  (m &gt;&gt;= f) &gt;&gt;= g  ==  m &gt;&gt;= (\x -&gt; f x &gt;&gt;= g)</font>
  <font color=Blue>-- Law 3'. (f &gt;=&gt; g) &gt;=&gt; h  ==  f &gt;=&gt; (g &gt;=&gt; h)</font>

liftM    <font color="#808080">::</font> <font color="#808080">(</font><font color=Green>Monad</font> m<font color="#808080">)</font> <font color="#808080">=&gt;</font> <font color="#808080">(</font>a <font color="#808080">-&gt;</font> b<font color="#808080">)</font>      <font color="#808080">-&gt;</font> <font color="#808080">(</font>m a <font color="#808080">-&gt;</font> m b<font color="#808080">)</font>
liftM2   <font color="#808080">::</font> <font color="#808080">(</font><font color=Green>Monad</font> m<font color="#808080">)</font> <font color="#808080">=&gt;</font> <font color="#808080">(</font>a <font color="#808080">-&gt;</font> b <font color="#808080">-&gt;</font> c<font color="#808080">)</font> <font color="#808080">-&gt;</font> <font color="#808080">(</font>m a <font color="#808080">-&gt;</font> m b <font color="#808080">-&gt;</font> m c<font color="#808080">)</font>



<font color=Blue>----------------------------------------------------------------</font>
<font color=Blue>-- Control.Monad.Reader</font>
<u><font color="#804000">newtype</font></u>    <font color=Green>ReaderT</font> r m a <font color="#808080">=</font> <font color=Green>ReaderT</font> <font color="#808080">{</font> runReaderT <font color="#808080">::</font> r <font color="#808080">-&gt;</font> m a <font color="#808080">}</font>
<font color=Blue>-- newtype Reader  r   a = Reader  { runReader  :: r -&gt;   a }</font>
<u><font color="#804000">type</font></u> <font color=Green>Reader</font> r <font color="#808080">=</font> <font color=Green>ReaderT</font> r <font color=Green>Identity</font>

<u><font color="#804000">class</font></u> <font color="#808080">(</font><font color=Green>Monad</font> m<font color="#808080">)</font> <font color="#808080">=&gt;</font> <font color=Green>MonadReader</font> r m <font color="#808080">|</font> m <font color="#808080">-&gt;</font> r <u><font color="#804000">where</font></u>
    ask   <font color="#808080">::</font> m r
    local <font color="#808080">::</font> <font color="#808080">(</font>r <font color="#808080">-&gt;</font> r<font color="#808080">)</font> <font color="#808080">-&gt;</font> m a <font color="#808080">-&gt;</font> m a



<font color=Blue>----------------------------------------------------------------</font>
<font color=Blue>-- Control.Monad.State</font>
<u><font color="#804000">newtype</font></u>    <font color=Green>StateT</font> s m a <font color="#808080">=</font> <font color=Green>StateT</font> <font color="#808080">{</font> runStateT <font color="#808080">::</font> s <font color="#808080">-&gt;</font> m <font color="#808080">(</font>a<font color="#808080">,</font> s<font color="#808080">)</font> <font color="#808080">}</font>
<font color=Blue>-- newtype State  s   a = State  { runState  :: s -&gt;   (a, s) }</font>
<u><font color="#804000">type</font></u> <font color=Green>State</font> s <font color="#808080">=</font> <font color=Green>StateT</font> s <font color=Green>Identity</font>
<u><font color="#804000">class</font></u> <font color="#808080">(</font><font color=Green>Monad</font> m<font color="#808080">)</font> <font color="#808080">=&gt;</font> <font color=Green>MonadState</font> s m <font color="#808080">|</font> m <font color="#808080">-&gt;</font> s <u><font color="#804000">where</font></u>
    get <font color="#808080">::</font> m s
    put <font color="#808080">::</font> s <font color="#808080">-&gt;</font> m <font color=Green>()</font>

gets    <font color="#808080">::</font> <font color="#808080">(</font><font color=Green>MonadState</font> s m<font color="#808080">)</font> <font color="#808080">=&gt;</font> <font color="#808080">(</font>s <font color="#808080">-&gt;</font> a<font color="#808080">)</font> <font color="#808080">-&gt;</font> m a
modify  <font color="#808080">::</font> <font color="#808080">(</font><font color=Green>MonadState</font> s m<font color="#808080">)</font> <font color="#808080">=&gt;</font> <font color="#808080">(</font>s <font color="#808080">-&gt;</font> s<font color="#808080">)</font> <font color="#808080">-&gt;</font> m <font color=Green>()</font>




<font color=Blue>----------------------------------------------------------------</font>
<font color=Blue>-- Control.Monad.Error</font>
<u><font color="#804000">data</font></u> <font color=Green>Either</font> e a <font color="#808080">=</font> <font color=Green>Left</font> e <font color="#808080">|</font> <font color=Green>Right</font> a <font color=Blue>-- Haskell Prelude</font>
<font color=Blue>-- Either e is already MonadError</font>
<u><font color="#804000">newtype</font></u> <font color=Green>ErrorT</font> e m a <font color="#808080">=</font> <font color=Green>ErrorT</font> <font color="#808080">{</font> runErrorT <font color="#808080">::</font> m <font color="#808080">(</font><font color=Green>Either</font> e a<font color="#808080">)</font> <font color="#808080">}</font>

<u><font color="#804000">class</font></u> <font color="#808080">(</font><font color=Green>Monad</font> m<font color="#808080">)</font> <font color="#808080">=&gt;</font> <font color=Green>MonadError</font> e m <font color="#808080">|</font> m <font color="#808080">-&gt;</font> e <u><font color="#804000">where</font></u>
    throwError <font color="#808080">::</font> e <font color="#808080">-&gt;</font> m a
    catchError <font color="#808080">::</font> m a <font color="#808080">-&gt;</font> <font color="#808080">(</font>e <font color="#808080">-&gt;</font> m a<font color="#808080">)</font> <font color="#808080">-&gt;</font> m a





<font color=Blue>-- CMW is not used in the Lect. 5 application, but often useful</font>
<font color=Blue>----------------------------------------------------------------</font>
<font color=Blue>-- Control.Monad.Writer</font>
<u><font color="#804000">newtype</font></u>    <font color=Green>WriterT</font> w m a <font color="#808080">=</font> <font color=Green>WriterT</font> <font color="#808080">{</font> runWriterT <font color="#808080">::</font> m <font color="#808080">(</font>a<font color="#808080">,</font> w<font color="#808080">)</font> <font color="#808080">}</font>
<font color=Blue>-- newtype Writer  w   a = Writer  { runWriter  :: (a, w) }</font>
<u><font color="#804000">type</font></u> <font color=Green>Writer</font> w <font color="#808080">=</font> <font color=Green>WriterT</font> w <font color=Green>Identity</font>

<u><font color="#804000">instance</font></u> <font color="#808080">(</font><font color=Green>Monoid</font> w<font color="#808080">,</font> <font color=Green>Monad</font> m<font color="#808080">)</font> <font color="#808080">=&gt;</font> <font color=Green>Monad</font> <font color="#808080">(</font><font color=Green>WriterT</font> w m<font color="#808080">)</font>
<u><font color="#804000">class</font></u> <font color="#808080">(</font><font color=Green>Monoid</font> w<font color="#808080">,</font> <font color=Green>Monad</font> m<font color="#808080">)</font> <font color="#808080">=&gt;</font> <font color=Green>MonadWriter</font> w m <font color="#808080">|</font> m <font color="#808080">-&gt;</font> w <u><font color="#804000">where</font></u>
    tell   <font color="#808080">::</font> w <font color="#808080">-&gt;</font> m <font color=Green>()</font>
    listen <font color="#808080">::</font> m a <font color="#808080">-&gt;</font> m <font color="#808080">(</font>a<font color="#808080">,</font> w<font color="#808080">)</font>
    pass   <font color="#808080">::</font> m <font color="#808080">(</font>a<font color="#808080">,</font> w <font color="#808080">-&gt;</font> w<font color="#808080">)</font> <font color="#808080">-&gt;</font> m a
</pre>
</body>
</html>